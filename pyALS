#!/usr/bin/python3
"""
Copyright 2021 Salvatore Barone <salvatore.barone@unina.it>

This is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free
Software Foundation; either version 3 of the License, or any later version.

This is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
more details.

You should have received a copy of the GNU General Public License along with
RMEncoder; if not, write to the Free Software Foundation, Inc., 51 Franklin
Street, Fifth Floor, Boston, MA 02110-1301, USA.
"""
import sys
from src.ALSPass import *

def cli_parser():
  parser = argparse.ArgumentParser()
  parser.add_argument("--source","--input", type = str, dest = "source", help="Select the input source file")
  parser.add_argument("--top", type = str, dest = "top", help="Select the top-module entity.")
  args, left = parser.parse_known_args()
  sys.argv = sys.argv[:1] + left
  return args

if __name__ == '__main__':
  args = cli_parser()
  design = ys.Design()
  ys.run_pass("read_verilog -sv " + str(args.source), design)
  ys.run_pass("hierarchy -check -top " + args.top, design)
  als = ALSPass()
  als.py_execute(sys.argv[1:], design)